name: Dockerized tests

on:
  push:
    branches:
      - docker-compose-for-dev
  pull_request:
    branches: [docker-compose-for-dev]
    types: [opened, synchronize]
  workflow_dispatch:

env:
  AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}
  AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
  AWS_REGION: eu-west-1

jobs:
  testing:
    runs-on: ubuntu-18.04
    steps:
      - uses: actions/checkout@v2
      - name: run docker compose 
        run: docker-compose -f docker-compose.test.yml up --build --exit-code-from pytest --abort-on-container-exit
